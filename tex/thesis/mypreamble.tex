%%%
%%% Shared preamble for all files, e.g. thesis, TikZ standalones, slides, etc.
%%% It defines \macros for types, Turing machines, etc.
%%%

% Packages needed
\usepackage[utf8]{inputenc}
\usepackage{geometry}
\usepackage[small,compact]{titlesec}
\usepackage[final]{listings}
\usepackage{amsmath}
\usepackage[amsmath,hyperref,thmmarks]{ntheorem}
% Warning: The package ntheorem defines a \None macro!
\usepackage{amssymb}
\usepackage{tipa}
\usepackage[english]{babel}
\usepackage{lstautogobble}
\usepackage{proof}
\usepackage{bussproofs}
\usepackage{xparse}
\usepackage{needspace}
\usepackage{xspace}
\usepackage{mathpartir}
\usepackage{stmaryrd} % for |llbracket and \rrbracket
\usepackage{standalone} % useful to out-source graphics


% TikZ ist *kein* Zeichenprogramm.
\usepackage{tikz}
\usetikzlibrary{arrows,shapes,snakes,automata,backgrounds,fit,positioning}
\usepackage{tikz-cd} % for commutative diagrams


%% Formating
\newcommand{\MS}[1]{\ensuremath{\mathsf{#1}}}
\newcommand{\MST}[1]{${\mathsf{#1}}$}
\newcommand{\IsMathMode}{\ifmmode{This is math mode}\else{This is not math mode}\fi}

%% Logic symbols
\newcommand{\defop}{\mathop{:=}}
\newcommand{\imp}{\mathbin{\rightarrow}~}
\newcommand{\Imp}{\mathbin{\Rightarrow}~}
\renewcommand{\iff}{\mathbin{\leftrightarrow}}


% ++ operator:
% Source: https://tex.stackexchange.com/questions/4194/how-to-typeset-haskell-operator-and-friends
\newcommand\doubleplus{+\kern-1.3ex+\kern0.8ex}
\newcommand\mdoubleplus{\ensuremath{\mathbin{+\mkern-10mu+}}}
\newcommand{\app}{\mdoubleplus}

\newcommand{\rew}{\Rightarrow}
\newcommand{\trew}{\stackrel{\textrm{T}}\Rightarrow}
\newcommand{\llrew}{\stackrel{\textrm{L}}\Rightarrow}
\newcommand{\rlrew}{\stackrel{\textrm{R}}\Rightarrow}
\newcommand{\arew}{\triangleright}
\newcommand{\conc}{\mathop{{+}\hskip-5pt{+}}}
\newcommand{\gen}{\Rightarrow}

%% Sets
% \newcommand{\lam}[2]{\lambda#1{.}\hskip.7pt#2}
\newcommand{\setOf}[1]{\bigl\{ #1 \bigr \}}
\newcommand{\setMap}[2]{\setOf{#1~\big|~#2}}
\newcommand{\depPair}[2]{\setOf{#1~{\&}~#2}}
\newcommand{\pair}[2]{\bigl( #1 , #2 \bigr)}
\newcommand{\class}[1]{\bigl[ #1 \bigr]}
\newcommand{\choice}[1]{\bigl< #1 \bigr>}
\newcommand{\explainRel}[2]{\stackrel{\text{#1}}{#2}}
\newcommand{\family}[2]{\bigl( #1 \bigr)_{#2}}
\newcommand{\from}{:}
\renewcommand{\to}{\rightarrow}

%% Types
\newcommand{\Bool}{\mathbb{B}}
\newcommand{\Fin}{\mathbb{F}}
\newcommand{\Nat}{\mathbb{N}}
\newcommand{\Prop}{\mathbb{P}}
\newcommand{\Type}{\mathbb{T}}
\newcommand{\Unit}{\MS{1}}
\newcommand{\Option}{\mathcal{O}}
\newcommand{\List}{\mathcal{L}}
\newcommand{\Rel}{\MS{Rel}}

\newcommand{\True}{\top}
\newcommand{\False}{\bot}

%% Tapes
\newcommand{\tape}[1]{[ #1 ]}
\newcommand{\tapePointer}[1]{\underset{\uparrow}{#1}}
\newcommand{\niltape}{\tape{\tapePointer{}}}
\newcommand{\midtape}[3]{\tape{#1~\tapePointer{#2}~#3}}
\newcommand{\leftof}[2]{\tape{\tapePointer{}~#1~#2}}
\newcommand{\rightof}[2]{\tape{#1~#2~\tapePointer{}}}

% \newcommand{\niltape}{\MS{niltape}}
% \newcommand{\midtape}[3]{\MS{midtape}~#1~#2~#3}
% \newcommand{\leftof}[2]{\MS{leftof}~#1~#2}
% \newcommand{\rightof}[2]{\MS{rightof}~#1~#2}

%% Turing machine types
\newcommand{\Loop}{\MS{loop}}
\newcommand{\Tape}{\MS{Tape}}
\newcommand{\Tapes}[1]{\Tape^{#1}}
\newcommand{\TM}{\MS{TM}}
\newcommand{\Move}{\MS{Move}}
\newcommand{\Act}{\MS{Act}}
\newcommand{\Conf}{\MS{Conf}}
\newcommand{\Tau}{\Gamma}

%% Relations
\newcommand{\rif}{\mathbin{\phi}}
\newcommand{\at} [2][]{#1{|}_{#2}}
\newcommand{\att}[2][]{#1{|\mkern-1.5mu|}_{#2}}
\DeclareMathOperator{\ignoreParam}{\Uparrow}
\DeclareMathOperator{\hideParam}{\Downarrow}


%% Constructors
\DeclareMathOperator{\inl}{\ensuremath{\MS{inl}}}
\DeclareMathOperator{\inr}{\ensuremath{\MS{inr}}}
\newcommand{\Some}[1]{\left\lfloor {#1} \right\rfloor}
% \None is defined sometimes
\renewcommand{\None}{\emptyset}
\newcommand{\true}{\MS{true}}
\newcommand{\false}{\MS{false}}
\newcommand{\unit}{\MS{()}}
\newcommand{\nil}{\MS{nil}}
\newcommand{\cons}{\mathbin{::}}

%% Functions
\newcommand{\map}[2]{\ensuremath{\MS{map}~#1~#2}}
\newcommand{\maptwo}[3]{\ensuremath{\MS{map}_2~#1~#2~#3}}
\newcommand{\rev}[1]{\MS{rev}~#1}

%% Vector
\newcommand{\Vector}[1]{\left[ #1 \right]}
\DeclareMathOperator{\hd}{\ensuremath{\MS{hd}}}
\DeclareMathOperator{\tl}{\ensuremath{\MS{tl}}}
\newcommand{\length}[1]{\left| #1 \right|}
\newcommand{\blength}[1]{\bigl| #1 \bigr|}


%%
%% Encding
%%
\newcommand{\contains}{\simeq}
\newcommand{\size}[1]{\length{encode(#1)}}

%% Semantics
\newcommand{\terminates}{\mathrel{\triangleright}}
\newcommand{\TerminatesIn}{\mathrel{\downarrow}}
\newcommand{\Realise}{\mathrel{\vDash}}
\newcommand{\RealiseIn}[1]{\mathrel{\vDash^{#1}}}

%%
%% Turing Machines
%%

%% Control flow operators
\newcommand{\While}{\MS{While}}
\newcommand{\Seq}{;~}
\newcommand{\Match}{\MS{Match}}
\newcommand{\If}[3]{\MS{If}~#1~\MS{Then}~#2~\MS{Else}~#3}
\newcommand{\Let}[2]{\MS{let}~#1~\MS{in}~#2}
\newcommand{\cond}[3]{\MS{if}~#1~\MS{then}~#2~\MS{else}~#3}
\newcommand{\Nop}{\MS{Nop}}
\newcommand{\Return}[2]{\MS{Return}~#1~#2}
% \newcommand{\Return}[2]{\MS{Return}_{#2}~#1}

%% Lifts
% #1 is the machine, #2 the lifting
\newcommand{\LiftTapes}[2]{\mathop{\Uparrow_{#2}} #1}
\newcommand{\LiftAlphabet}[2]{\mathop{\Uparrow_{#2}} #1}
% #1 is the machine, #2 the alphabet lifting, and #3 the tape-lifting
\newcommand{\LiftBoth}[3]{\mathop{\Uparrow_{#2;~#3}} #1}




%%%
%%% lstlisting
%%%

% Style and language to define complex multi-line definitions similar to Coq code
\lstdefinelanguage{semicoq}{
  keywords={if,then,else,true,false,match,Match,If,Then,Else,Nop,Return,Move,Reset,DoAct,WriteMove,L,R,N},
  comment=[s]{(*}{*)},
}

\lstdefinestyle{semicoqstyle}{
  mathescape=true,
  keywordstyle=\textsf,
  language=semicoq,
  literate={
    {=>}{{$\Rightarrow$}}2
    {>->}{{$\rightarrowtail\,$}}2
    {<->}{{$\leftrightarrow$ }}2
    {->}{{$\to$ }}3
    {~}{{$\lnot$}}1
    {/\\}{{$\land$}}2
    {\\/}{{$\lor$}}2
    {forall}{{$\forall$}}1
    {exists}{{$\exists$}}1
    {<>}{{$\not =$}}{1}
    {<=}{{$\leq$}}{1}
    {<}{{$\lt$}}{1}
    {>=}{{$\ge$}}{1}
    {>}{{$\gt$}}{1}
    % {Match}{$\mathsf{Match}$}{5}
    % {match}{$\textsf{match}$}{5}
    % {If}{$\MS{If}$}{5}
    % {if}{$\MS{if}$}{5}
    % {Then}{$\MS{Then}$}{5}
    % {then}{$\MS{then}$}{5}
    % {Else}{$\MS{Else}$}{5}
    % {else}{$\MS{else}$}{5}
  }
}

\lstdefinelanguage{pseudocode}{
  keywords={If,Then,Else,Do,While,Reset,Return},
}

\lstdefinestyle{pseudocode}{
  mathescape=true,
  language=pseudocode,
  literate={
    {:=}{{$\leftarrow$}}{1}
    {<>}{{$\not =$}}{1}
    {<=}{{$\leq$}}{1}
    {<}{{$\lt$}}{1}
    {>=}{{$\ge$}}{1}
    {>}{{$\gt$}}{1}
  }
}






%%% Local Variables:
%%% mode: LaTeX
%%% TeX-master: "thesis"
%%% End: